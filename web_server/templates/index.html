
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>V Cube - Register / Login</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
  </head>
  <body>
    <div class="container py-5">
      <div class="row justify-content-center">
        <div class="col-md-8">
          <div class="card" style="background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border: none; box-shadow: 0 8px 32px rgba(0,0,0,0.1);">
            <div class="card-body">
              <div class="text-center mb-4">
                <h2 class="card-title" style="color: var(--primary-color); font-weight: 700; font-size: 2.5rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.1);">V Cube Software Solutions</h2>
                <p class="text-muted" style="font-size: 1.1rem;">Your Gateway to Technical Excellence</p>
              </div>
              <div class="d-flex justify-content-center mb-4">
                <div class="btn-group" role="group" id="authTabs">
                  <button class="button" id="tab-register" style="border-radius: 4px 0 0 4px;">Register</button>
                  <button class="button" id="tab-login" style="background-color: var(--secondary-color); border-radius: 0 4px 4px 0;">Login</button>
                </div>
              </div>

              <div id="registerForm" class="mt-4">
                <form id="form-register">
                  <div class="mb-3">
                    <label class="form-label">Full Name</label>
                    <input type="text" id="r_name" class="form-control" required placeholder="Enter your full name">
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Email Address</label>
                    <input type="email" id="r_email" class="form-control" required placeholder="your.email@example.com">
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Select Course</label>
                    <select id="r_course" class="form-select" required>
                      <option value="" disabled selected>Choose your course</option>
                      <option value="Multi cloud">Multi Cloud Computing</option>
                      <option value="Java">Java Development</option>
                      <option value="Python">Python Programming</option>
                      <option value="Other">Other Courses</option>
                    </select>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Create Password</label>
                    <input type="password" id="r_password" class="form-control" required placeholder="Create a strong password">
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Confirm Password</label>
                    <input type="password" id="r_password2" class="form-control" required placeholder="Re-enter your password">
                  </div>
                  <button type="submit" class="button w-100">Create Account</button>
                </form>
              </div>

              <div id="loginForm" class="mt-4" style="display:none;">
                <form id="form-login">
                  <div class="mb-3">
                    <label class="form-label">Email Address</label>
                    <input type="email" id="l_email" class="form-control" required placeholder="Enter your email">
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Password</label>
                    <input type="password" id="l_password" class="form-control" required placeholder="Enter your password">
                  </div>
                  <button type="submit" class="button w-100" style="background-color: var(--secondary-color);">Sign In</button>
                </form>
              </div>

              <div id="msg" class="mt-3"></div>

            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      const API = '';
      const show = (id)=>{ document.querySelectorAll('#registerForm,#loginForm').forEach(e=>e.style.display='none'); document.getElementById(id).style.display='block'; }
      document.getElementById('tab-register').addEventListener('click', ()=>{ show('registerForm'); document.getElementById('tab-register').classList.add('active'); document.getElementById('tab-login').classList.remove('active'); });
      document.getElementById('tab-login').addEventListener('click', ()=>{ show('loginForm'); document.getElementById('tab-login').classList.add('active'); document.getElementById('tab-register').classList.remove('active'); });

      const msg = (t, cls='alert-info')=>{ const el = document.getElementById('msg'); el.innerHTML = `<div class="alert ${cls}" role="alert">${t}</div>`; window.scrollTo(0,0); }

      document.getElementById('form-register').addEventListener('submit', async (e)=>{
        e.preventDefault();
        const name = document.getElementById('r_name').value;
        const email = document.getElementById('r_email').value;
        const course = document.getElementById('r_course').value;
        const password = document.getElementById('r_password').value;
        const password2 = document.getElementById('r_password2').value;
        if(password !== password2){ msg('Passwords do not match','alert-danger'); return; }
        try{
          const res = await fetch(API + '/api/register', { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({name,email,course,password}) });
          const j = await res.json();
          if(res.ok){ msg('Registered successfully! Please login.','alert-success'); show('loginForm'); } else { msg(j.message || 'Registration failed','alert-danger'); }
        }catch(err){ msg('Could not reach API server: ' + err,'alert-danger'); }
      });

      document.getElementById('form-login').addEventListener('submit', async (e)=>{
        e.preventDefault();
        const email = document.getElementById('l_email').value;
        const password = document.getElementById('l_password').value;
        try{
          const res = await fetch(API + '/api/login', { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({email,password}) });
          const j = await res.json();
          if(res.ok){
            // save token and user info in localStorage
            localStorage.setItem('token', j.token);
            localStorage.setItem('user', JSON.stringify(j.user));
            window.location = '/dashboard';
          } else {
            msg(j.message || 'Login failed','alert-danger');
          }
        }catch(err){ msg('Could not reach API server: ' + err,'alert-danger'); }
      });
    </script>
  </body>
</html>
